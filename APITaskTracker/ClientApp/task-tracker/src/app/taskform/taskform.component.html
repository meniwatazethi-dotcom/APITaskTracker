<div class="container py-4">
  <h2 class="mb-4 text-center">{{ isEdit ? 'Edit Task' : 'Create Task' }}</h2>

  <div *ngIf="loading" class="text-center">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>

  <form [formGroup]="form" (ngSubmit)="save()" *ngIf="!loading" class="card shadow p-4">
    <!-- Title -->
    <div class="mb-3">
      <label class="form-label fw-semibold">Title</label>
      <input type="text" formControlName="title" class="form-control" placeholder="Enter task title" />
      <div *ngIf="f['title'].touched && f['title'].invalid" class="text-danger small mt-1">
        Title is required and must be at least 3 characters.
      </div>


    </div>

    <!-- Description -->
    <div class="mb-3">
      <label class="form-label fw-semibold">Description</label>
      <textarea formControlName="description" class="form-control" rows="3"
        placeholder="Enter task description"></textarea>
    </div>

    <!-- Status -->
    <div class="mb-3">
      <label class="form-label fw-semibold">Status</label>
      <select formControlName="status" class="form-select">
        <option *ngFor="let s of statusKeys" [value]="TaskItemStatus[s]">
          {{ s }}
        </option>
      </select>
    </div>

    <!-- Priority -->
    <div class="mb-3">
      <label class="form-label fw-semibold">Priority</label>
      <select formControlName="priority" class="form-select">
        <option *ngFor="let p of priorityKeys" [value]="TaskPriority[p]">
          {{ p }}
        </option>
      </select>
    </div>

    <!-- Due Date -->
    <div class="mb-3">
      <label class="form-label fw-semibold">Due Date</label>
      <input type="date" formControlName="dueDate" class="form-control" />
    </div>

    <!-- Buttons -->
    <div class="d-flex justify-content-end gap-2 mt-4">
      <button type="button" class="btn btn-outline-secondary" (click)="router.navigate(['/'])">
        Cancel
      </button>
      <button type="submit" class="btn btn-primary" [disabled]="loading">
        {{ isEdit ? 'Update' : 'Create' }}
      </button>
    </div>

    <div *ngIf="error" class="alert alert-danger mt-3">
      {{ error }}
    </div>
  </form>
</div>